{# vim: set tabstop=2 shiftwidth=2 #}
{#
# GNU MediaGoblin -- federated, autonomous media hosting
# Copyright (C) 2011, 2012 MediaGoblin contributors.  See AUTHORS.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
-#}
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ app_config['html_title'] }}{% endblock %}</title>
    <link rel="stylesheet"
        href="{{ request.staticdirect('/bootstrap/css/bootstrap.css', 'theme') }}" />
    <link rel="stylesheet"
        href="{{ request.staticdirect('/bootstrap/css/bootstrap-responsive.css', 'theme') }}" />
    <link rel="stylesheet"
        href="{{ request.staticdirect('/css/goblinboots.css', 'theme') }}" />
    <link rel="shortcut icon"
          href="{{ request.staticdirect('/images/goblin.ico') }}" />

    <style>
    /* @font-face */

    @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 700;
        src: local('Lato Bold'), local('Lato-Bold'),
        url('{{ request.staticdirect('/fonts/Lato-Bold.ttf') }}') format('truetype');
    }
    @font-face {
        font-family: 'Lato';
        font-style: italic;
        font-weight: 400;
        src: local('Lato Italic'), local('Lato-Italic'),
        url('{{ request.staticdirect('/fonts/Lato-Italic.ttf') }}') format('truetype');
    }
    @font-face {
        font-family: 'Lato';
        font-style: italic;
        font-weight: 700;
        src: local('Lato Bold Italic'), local('Lato-BoldItalic'),
        url('{{ request.staticdirect('/fonts/Lato-BoldItalic.ttf') }}') format('truetype');
    }
    @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 400;
        src: local('Lato Regular'), local('Lato-Regular'),
        url('{{ request.staticdirect('/fonts/Lato-Regular.ttf') }}') format('truetype');
    }
    .thumbnail {
        text-align: center;
        overflow: ellipsis;
    }
    </style>

    {% include "mediagoblin/extra_head.html" %}

    {% block mediagoblin_head %}
    {% endblock mediagoblin_head %}
  </head>
  <body>
    {% block mediagoblin_body %}
    <div class="navbar navbar-static-top">
      {% block mediagoblin_header %}
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          {%- include "mediagoblin/bits/logo.html" -%}
          <div class="nav-collapse collapse">
            <ul class="nav pull-right">
              {% if request.user %}
              {% if request.user and request.user.status == "needs_email_verification" %}
              {# the following link should only appear when verification is needed #}
              <li><a href="{{ request.urlgen('mediagoblin.user_pages.user_home',
                                user=request.user.username) }}"
                    class="button_action_highlight">
                {% trans %}Verify your email!{% endtrans %}</a>
              or <a href="{{ request.urlgen('mediagoblin.auth.logout') }}">{% trans %}log out{% endtrans %}</a></li>
              {% endif %}
              {% else %}
              <li><a href="{{ request.urlgen('mediagoblin.auth.login') }}?next={{
                                                request.base_url|urlencode }}">
                                                {% trans %}Log in{% endtrans %}</a></li>
              {% endif %}
              {% if request.user and request.user.status == 'active' %}
              <li><a class="button_action" href="{{ request.urlgen('mediagoblin.submit.start') }}">
                {%- trans %}Add media{% endtrans -%}
              </a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle"
                  data-toggle="dropdown">{{ request.user.username }}
                  <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                  <li><a href="{{ request.urlgen('mediagoblin.user_pages.user_home',
                    user=request.user.username) }}">Profile</a></li>
                  <li><a class="button_action" href="{{ request.urlgen('mediagoblin.submit.collection') }}">
                    {%- trans %}Create new collection{% endtrans -%}
                  </a></li>
                  <li><a href="{{ request.urlgen('mediagoblin.edit.account') }}">
                    {%- trans %}Change account settings{% endtrans -%}
                  </a></li>
                  <li><a href="{{ request.urlgen('mediagoblin.user_pages.processing_panel',
                                                  user=request.user.username) }}">
                    {%- trans %}Media processing panel{% endtrans -%}
                  </a></li>
                  <li class="divider"></li>
                  <li><a href="{{ request.urlgen('mediagoblin.auth.logout') }}">
                    {% trans %}Log out{% endtrans %}</a>
                  </li>
                </ul>
              </li>
              {% if request.user.is_admin %}
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  Admin
                  <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="{{ request.urlgen('mediagoblin.admin.panel') }}">
                    {%- trans %}Media processing panel{% endtrans -%}
                  </a></li>
                </ul>
              </li>
              {% endif %}
            {% endif %}
            </ul>
          </div><!-- /nav-collapse -->
        </div><!-- /container -->
      </div><!-- /navbar-inner -->
      {% endblock %}
    </div><!-- /navbar -->
    <div class="container">
        {% include "mediagoblin/utils/messages.html" %}
        {% block mediagoblin_header_title %}{% endblock %}
        {% block mediagoblin_content %}
        {% endblock mediagoblin_content %}
      <hr />
      {% block mediagoblin_footer %}
      <footer>
        {% trans -%}
          Powered by <a href="http://mediagoblin.org">MediaGoblin</a>, a <a href="http://gnu.org/">GNU</a> project.
        {%- endtrans %}
        {% trans source_link=app_config['source_link'] -%}
          Released under the <a href="http://www.fsf.org/licensing/licenses/agpl-3.0.html">AGPL</a>. <a href="{{ source_link }}">Source code</a> available.
        {%- endtrans %}
      </footer>
      {% endblock mediagoblin_footer %}
    {% endblock mediagoblin_body %}
    </div>
    {% block mediagoblin_scripts %}
    <script src="{{ request.staticdirect('/js/extlib/jquery.js') }}"></script>
    <script src="{{ request.staticdirect('/bootstrap/js/bootstrap.js', 'theme') }}"></script>

    <!--[if lt IE 9]>
      <script src="{{ request.staticdirect('/js/extlib/html5shiv.js') }}"></script>
    <![endif]-->
    {% endblock %}
    {% include 'local/tracking.html' ignore missing %}
  </body>
</html>
